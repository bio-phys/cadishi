<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cadishi documentation &#8212; Cadishi 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cadishi modules" href="modules.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Cadishi modules"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Cadishi 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cadishi-documentation">
<h1>Cadishi documentation<a class="headerlink" href="#cadishi-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Cadishi package is designed to perform fast computations of histograms of
the (Euclidean) distances between objects. For example, these objects may be
atoms from molecular dynamics (MD) simulation datasets, or stars or galaxies
from astrophysical datasets. While Cadishi is written mostly in Python, it is
built upon high-performance kernels written in C++ and CUDA to exploit the CPU
and GPU resources of a compute node as best as possible.</p>
<p>In the field of MD simulations, Cadishi is most useful in conjunction with the
Capriqorn package. The name Cadishi is simply an acronym derived from (or, more
precisely, the syllabic abbreviation of) <em>calculation of distance histograms</em>.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Cadishi requires a Python 2.7 installation including the NumPy, SciPy, Cython,
h5py, and PyYAML modules. We recommend to use the Anaconda Python Distribution
which provides all the necessary modules out of the box. Cadishi was mostly
developed using Anaconda Python 2, versions 4.0.0 and newer. Moreover, to
compile the high-performance kernels, recent GCC and CUDA (optional)
installations are required. GCC 4.9 and GCC 5.4, and CUDA 7.5 and 8.0 were used
successfully. Note that Python 3 is currently not supported.</p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<p>Cadishi features a two-level parallelization. On the top level, Cadishi
parallelizes over frames (i.e. snapshots of the ensemble of objects at certain
points in time) using the Python multiprocessing module. A single frame is
processed by a single worker process running a CPU or GPU kernel. Multiple
worker processes may run simultaneously on a shared-memory multi-core machine.
On the frame level, OpenMP threads are used by the CPU kernel, and CUDA threads
are used by the GPU kernel. Hence, it is possible to fully exploit the
resources of a shared-memory machine. E.g., on a dual-socket server with two
GPUs, Cadishi would use two CPU worker processes (one per multi-core chip) and
two GPU worker processes (one per GPU card).</p>
<p>Optionally, Cadishi supports orthorhombic periodic boxes, applying the minimum
image convention to the distances internally. Support for triclinic boxes is
implemented following the equations given by Tuckerman (M. E. Tuckerman.
Statistical Mechanics: Theory and Molecular Simulation. Oxford University Press,
Oxford, UK, 2010.).  Note that we consider support for triclinic boxes as highly
experimental. Check your results carefully since we have seen inconsistencies.</p>
<p>Computations can be performed in single (default) or double precision.
Optionally, the distances can be checked if they fit into the desired histogram
width. Given the combinatorial space resulting from these possibilities,
templated C++ code is used to generate machine code with a minimum amount of
branches at runtime. Recent compilers are known to generate well-vectorized
machine code from the distance calculation for the CPU. The GPU kernel benefits
strongly from the fast shared-memory atomic operations introduced with the
MAXWELL generation of NVIDIA GPUs.</p>
</div>
<div class="section" id="input-data-distance-histogram-computation-output-data">
<h2>Input data, distance histogram computation, output data<a class="headerlink" href="#input-data-distance-histogram-computation-output-data" title="Permalink to this headline">¶</a></h2>
<p><strong>Cadishi reads input data from an HDF5 file</strong> that is specified in the
<code class="docutils literal"><span class="pre">histograms.yaml</span></code> parameter file.  A typical file location is
<code class="docutils literal"><span class="pre">./preprocessor_output/trajectory.h5</span></code> when Cadishi is used in concert with
the Capriqorn package from the same authors. In any case the HDF5 file must have
a certain internal structure as shown in the following example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="n">coordinates</span><span class="o">/</span><span class="n">species_0</span>
               <span class="n">species_1</span>
               <span class="n">species_2</span>
               <span class="o">...</span>
<span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">coordinates</span><span class="o">/</span><span class="n">species_0</span>
               <span class="n">species_1</span>
               <span class="n">species_2</span>
               <span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Frames are numbered starting with 0. The number is used as the label for the
uppermost HDF5 group. For each frame the particle coordinates are stored in the
sub-group &#8216;coordinates&#8217;. Coordinate sets are double precision HDF5 datasets of
size (n_i, 3) where n_i is the number of particles of species i. The coordinate
datasets use the name of the species as the label which e.g. can be the name of
the chemical element in the context of MD data.</p>
<p>For each frame read from the HDF5 file <strong>Cadishi computes the distance histograms</strong>
between the particles for all combinations of species. The top-level parallelization
of Cadishi is able to compute multiple frames simultaneously on all GPUs and CPUs
available on a node. Within a frame the computation is highly parallelized using
threads.</p>
<p>Finally, <strong>Cadishi writes the histograms into HDF5 files</strong> according to the
following scheme:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="n">histograms</span><span class="o">/</span><span class="n">species_0</span><span class="p">,</span><span class="n">species_0</span>
              <span class="n">species_0</span><span class="p">,</span><span class="n">species_1</span>
              <span class="n">species_0</span><span class="p">,</span><span class="n">species_2</span>
              <span class="n">species_1</span><span class="p">,</span><span class="n">species_1</span>
              <span class="n">species_1</span><span class="p">,</span><span class="n">species_2</span>
              <span class="n">species_2</span><span class="p">,</span><span class="n">species_2</span>
              <span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The HDF5 histogram datasets are single-column vectors of 64 bit floats. The
latter was chosen to make averaging easier and more consistent.</p>
<p>To get an idea about all the options available please have a look at the example
parameter file that comes with Cadishi.  It can be generated using the command
<code class="docutils literal"><span class="pre">cadishi</span> <span class="pre">example</span> <span class="pre">--expert</span></code>.</p>
<p>To <strong>make life with HDF5 files easier</strong> we recommend to use a graphical HDF5
viewer such as HDFView.  Note, however, that HDFView does not support the LZF
compression that comes with the Python HDF5 module &#8220;H5py&#8221; and is used by Cadishi
by default (LZF can be disabled via the parameter file)). Moreover, Cadishi
comes with the HDF5 unpack (<code class="docutils literal"><span class="pre">cadishi</span> <span class="pre">unpack</span></code>) and the HDF5 merge tool
(<code class="docutils literal"><span class="pre">cadishi</span> <span class="pre">merge</span></code>). The latter tool can also be used to decompress single HDF5
files quickly before viewing them with HDFView.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>The package comes with a standard Python setup.py file.  It is installed e.g. as
follows into the user&#8217;s homedirectory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span>
</pre></div>
</div>
<p>In this case, setup.py copies the Cadishi files into the directory <code class="docutils literal"><span class="pre">~/.local</span></code>.
Make sure that your <code class="docutils literal"><span class="pre">PATH</span></code> environment variable includes the directory
<code class="docutils literal"><span class="pre">~/.local/bin</span></code>.  To enable a CUDA build the <code class="docutils literal"><span class="pre">nvcc</span></code> compiler wrapper must be
found via the <code class="docutils literal"><span class="pre">PATH</span></code> environment variable.  Influential boolean environment variables
are <code class="docutils literal"><span class="pre">CAD_DEBUG</span></code>, <code class="docutils literal"><span class="pre">CAD_OPENMP</span></code>, <code class="docutils literal"><span class="pre">CAD_CUDA</span></code>, and <code class="docutils literal"><span class="pre">CAD_SAFE_CUDA_FLAGS</span></code>; if
set they override the keys listed in the options section of the file <code class="docutils literal"><span class="pre">setup.cfg</span></code>.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The Cadishi package provides a single main executable <code class="docutils literal"><span class="pre">cadishi</span></code> which supports
commands and options (similar to the well-known concept used by <code class="docutils literal"><span class="pre">git</span></code>).</p>
<p>To get a quick overview on the options of Cadishi issue the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cadishi</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>To get started a parameter file controlling the distance histogram calculation
is required. A basic example is included with the package and can be created as
follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cadishi</span> <span class="n">example</span> <span class="p">[</span><span class="o">--</span><span class="n">expert</span><span class="p">]</span>
</pre></div>
</div>
<p>By default, the parameter file&#8217;s name is <code class="docutils literal"><span class="pre">histograms.yaml</span></code>. Edit the parameter
file to your needs.  In particular, the compute kernels <em>pydh</em> (CPU) and <em>cudh</em>
(GPU) can be configured.  In the example parameter file, the input configuration
points to the default test case included with the Cadishi package. Adapt the
input configuration to your actual data. As a second step the distance histogram
calculation is run as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cadishi</span> <span class="n">histo</span>
</pre></div>
</div>
</div>
<div class="section" id="source-documentation">
<h2>Source documentation<a class="headerlink" href="#source-documentation" title="Permalink to this headline">¶</a></h2>
<p>The documentation linked below is generated automatically from the docstrings
present in the Cadishi source code.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Cadishi modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi">cadishi</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.base">cadishi.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.io.ascii">cadishi.io.ascii</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.io.dummy">cadishi.io.dummy</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.io.hdf5">cadishi.io.hdf5</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.io.pickel">cadishi.io.pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.dict_util">cadishi.dict_util</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.dictfs">cadishi.dictfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.h5pickle">cadishi.h5pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.util">cadishi.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-cadishi.version">cadishi.version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kernel.html">Cadishi compute kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kernel.html#module-cadishi.kernel">cadishi.kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel.html#module-cadishi.kernel.common">cadishi.kernel.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel.html#module-cadishi.kernel.dist">cadishi.kernel.dist</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel.html#module-cadishi.kernel.pydh">cadishi.kernel.pydh</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel.html#module-cadishi.kernel.cudh">cadishi.kernel.cudh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="executables.html">Cadishi executables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="executables.html#module-cadishi.exe">cadishi.exe</a></li>
<li class="toctree-l2"><a class="reference internal" href="executables.html#module-cadishi.exe.cli">cadishi.exe.cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="executables.html#module-cadishi.exe.histograms">cadishi.exe.histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="executables.html#module-cadishi.exe.json2yaml">cadishi.exe.json2yaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="executables.html#module-cadishi.exe.yaml2json">cadishi.exe.yaml2json</a></li>
<li class="toctree-l2"><a class="reference internal" href="executables.html#module-cadishi.exe.unpack">cadishi.exe.unpack</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="license-and-citation">
<h2>License and Citation<a class="headerlink" href="#license-and-citation" title="Permalink to this headline">¶</a></h2>
<p>Cadishi is released under the permissive MIT license.  See the file
<cite>LICENSE.txt</cite> for details.</p>
<p>Copyright 2015-2017  Klaus Reuter (MPCDF), Juergen Koefinger (MPIBP)</p>
<p>In case you&#8217;re using Cadishi for your own academic or non-academic research, <strong>we
kindly request that you cite Cadishi in your publications and presentations</strong>. We
suggest the following citations as appropriate:</p>
<p>TODO: Add proper paper reference once it is publicly available. Please use the
following reference meanwhile:
&#8220;K. Reuter, J. Koefinger: Cadishi, <a class="reference external" href="https://github.com/bio-phys/cadishi">https://github.com/bio-phys/cadishi</a>, 2017.&#8221;</p>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Cadishi documentation</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#input-data-distance-histogram-computation-output-data">Input data, distance histogram computation, output data</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#source-documentation">Source documentation</a></li>
<li><a class="reference internal" href="#license-and-citation">License and Citation</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">Cadishi modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Cadishi modules"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Cadishi 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Klaus Reuter, Juergen Koefinger.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>